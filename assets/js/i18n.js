// Sistema de Internacionaliza√ß√£o (i18n)

const translations = {
    pt: {
        nav: {
            home: 'Home',
            about: 'Sobre N√≥s',
            products: 'Produtos',
            contact: 'Contato'
        },
        hero: {
            cafe: {
                title: 'A√á√öCAR',
                description: 'A√ß√∫car premium selecionado para distribui√ß√£o nacional e internacional'
            },
            soja: {
                title: 'SOJA',
                description: 'Soja certificada fornecida em gr√£os, farelo, √≥leo e derivados para todo o mercado'
            },
            comercio: {
                title: 'COM√âRCIO EXTERIOR',
                description: 'Importa√ß√£o e exporta√ß√£o de produtos aliment√≠cios com excel√™ncia e agilidade para todo o mundo'
            },
            milho: {
                title: 'MILHO',
                description: 'MILHO E FARELO DE MILHO'
            },
            verCategorias: 'Ver Categorias'
        },
        categories: {
            title: 'Nossas Categorias',
            description: 'Explore nosso portf√≥lio completo de produtos organizados por categoria'
        },
        highlights: {
            logistica: {
                title: 'Log√≠stica Nacional',
                description: 'Distribui√ß√£o eficiente para todo o territ√≥rio brasileiro'
            },
            qualidade: {
                title: 'Qualidade Garantida',
                description: 'Rigoroso controle de qualidade em todos os produtos'
            },
            atendimento: {
                title: 'Atendimento Premium',
                description: 'Suporte dedicado e personalizado para cada cliente'
            }
        },
        partners: {
            title: 'Nossos Parceiros',
            description: 'Trabalhamos com as melhores marcas do mercado para oferecer produtos de qualidade',
            info: 'Parcerias estrat√©gicas que garantem qualidade e confiabilidade'
        },
        cta: {
            title: 'DOM MIGUEL ATACADISTA',
            subtitle: 'Brasil',
            description1: 'Nossa estrutura de origina√ß√£o permite-nos atender desde pequenos at√© grandes volumes de produtos, inclusive em contratos extensivos.',
            description2: 'Uma outra vantagem, de termos esta grande rede de rela√ß√µes comerciais e acesso direto a produtores rurais, √© que podemos conseguir pre√ßos diferenciados na exporta√ß√£o para as v√°rias regi√µes atendidas.',
            vamosConversar: 'VAMOS CONVERSAR?'
        },
        product: {
            solicitarCotacao: 'Solicitar Cota√ß√£o',
            verMaisProdutos: 'Ver Mais Produtos',
            verDetalhes: 'Ver Detalhes',
            codigo: 'C√≥digo:',
            peso: 'Peso:',
            categoria: 'Categoria:',
            descricao: 'Descri√ß√£o'
        },
        breadcrumb: {
            home: 'Home',
            produtos: 'Produtos'
        }
    },
    es: {
        nav: {
            home: 'Inicio',
            about: 'Sobre Nosotros',
            products: 'Productos',
            contact: 'Contacto'
        },
        hero: {
            cafe: {
                title: 'AZ√öCAR',
                description: 'Az√∫car premium seleccionado para distribuci√≥n nacional e internacional'
            },
            soja: {
                title: 'SOJA',
                description: 'Soja certificada suministrada en granos, harina, aceite y derivados para todo el mercado'
            },
            comercio: {
                title: 'COMERCIO EXTERIOR',
                description: 'Importaci√≥n y exportaci√≥n de productos alimenticios con excelencia y agilidad para todo el mundo'
            },
            milho: {
                title: 'MA√çZ',
                description: 'MA√çZ Y HARINA DE MA√çZ'
            },
            verCategorias: 'Ver Categor√≠as'
        },
        categories: {
            title: 'Nuestras Categor√≠as',
            description: 'Explore nuestro portafolio completo de productos organizados por categor√≠a'
        },
        highlights: {
            logistica: {
                title: 'Log√≠stica Nacional',
                description: 'Distribuci√≥n eficiente para todo el territorio brasile√±o'
            },
            qualidade: {
                title: 'Calidad Garantizada',
                description: 'Riguroso control de calidad en todos los productos'
            },
            atendimento: {
                title: 'Atenci√≥n Premium',
                description: 'Soporte dedicado y personalizado para cada cliente'
            }
        },
        partners: {
            title: 'Nuestros Socios',
            description: 'Trabajamos con las mejores marcas del mercado para ofrecer productos de calidad',
            info: 'Asociaciones estrat√©gicas que garantizan calidad y confiabilidad'
        },
        cta: {
            title: 'DOM MIGUEL MAYORISTA',
            subtitle: 'Brasil',
            description1: 'Nuestra estructura de origen nos permite atender desde peque√±os hasta grandes vol√∫menes de productos, incluso en contratos extensivos.',
            description2: 'Otra ventaja de tener esta gran red de relaciones comerciales y acceso directo a productores rurales es que podemos obtener precios diferenciados en la exportaci√≥n para las diversas regiones atendidas.',
            vamosConversar: '¬øHABLEMOS?'
        },
        product: {
            solicitarCotacao: 'Solicitar Cotizaci√≥n',
            verMaisProdutos: 'Ver M√°s Productos',
            verDetalhes: 'Ver Detalles',
            codigo: 'C√≥digo:',
            peso: 'Peso:',
            categoria: 'Categor√≠a:',
            descricao: 'Descripci√≥n'
        },
        breadcrumb: {
            home: 'Inicio',
            produtos: 'Productos'
        }
    },
    en: {
        nav: {
            home: 'Home',
            about: 'About Us',
            products: 'Products',
            contact: 'Contact'
        },
        hero: {
            cafe: {
                title: 'SUGAR',
                description: 'Premium selected sugar for national and international distribution'
            },
            soja: {
                title: 'SOYBEAN',
                description: 'Certified soybean supplied in grains, meal, oil and derivatives for the entire market'
            },
            comercio: {
                title: 'FOREIGN TRADE',
                description: 'Import and export of food products with excellence and agility worldwide'
            },
            milho: {
                title: 'CORN',
                description: 'CORN AND CORN MEAL'
            },
            verCategorias: 'View Categories'
        },
        categories: {
            title: 'Our Categories',
            description: 'Explore our complete product portfolio organized by category'
        },
        highlights: {
            logistica: {
                title: 'National Logistics',
                description: 'Efficient distribution throughout the Brazilian territory'
            },
            qualidade: {
                title: 'Guaranteed Quality',
                description: 'Rigorous quality control on all products'
            },
            atendimento: {
                title: 'Premium Service',
                description: 'Dedicated and personalized support for each client'
            }
        },
        partners: {
            title: 'Our Partners',
            description: 'We work with the best brands in the market to offer quality products',
            info: 'Strategic partnerships that guarantee quality and reliability'
        },
        cta: {
            title: 'DOM MIGUEL WHOLESALER',
            subtitle: 'Brazil',
            description1: 'Our origination structure allows us to serve from small to large volumes of products, including extensive contracts.',
            description2: 'Another advantage of having this large network of commercial relationships and direct access to rural producers is that we can obtain differentiated prices for export to the various regions served.',
            vamosConversar: 'LET\'S TALK?'
        },
        product: {
            solicitarCotacao: 'Request Quote',
            verMaisProdutos: 'View More Products',
            verDetalhes: 'View Details',
            codigo: 'Code:',
            peso: 'Weight:',
            categoria: 'Category:',
            descricao: 'Description'
        },
        breadcrumb: {
            home: 'Home',
            produtos: 'Products'
        }
    }
};

// Idioma atual (padr√£o: portugu√™s)
let currentLang = localStorage.getItem('language') || 'pt';

// Fun√ß√£o para obter tradu√ß√£o
function t(key) {
    const keys = key.split('.');
    let value = translations[currentLang];
    
    for (const k of keys) {
        if (value && value[k]) {
            value = value[k];
        } else {
            // Fallback para portugu√™s se n√£o encontrar tradu√ß√£o
            value = translations.pt;
            for (const k2 of keys) {
                value = value[k2];
            }
            break;
        }
    }
    
    return value || key;
}

// Fun√ß√£o para trocar idioma
function setLanguage(lang) {
    console.log('setLanguage chamado com:', lang); // Debug
    if (!lang || !translations[lang]) {
        console.error('Idioma inv√°lido:', lang);
        return;
    }
    
    currentLang = lang;
    localStorage.setItem('language', lang);
    
    // Atualizar flag no bot√£o
    const flags = {
        pt: 'üáßüá∑',
        es: 'üá™üá∏',
        en: 'üá∫üá∏'
    };
    const currentFlag = document.getElementById('current-flag');
    if (currentFlag) {
        currentFlag.textContent = flags[lang] || 'üáßüá∑';
        console.log('Flag atualizada para:', flags[lang]); // Debug
    }
    
    // Atualizar todos os elementos com data-i18n
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        const translation = t(key);
        if (translation) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translation;
            } else if (element.tagName === 'A' && element.querySelector('i')) {
                // Para links com √≠cones, preservar o √≠cone
                const icon = element.querySelector('i');
                const iconHTML = icon ? icon.outerHTML : '';
                element.innerHTML = translation + (iconHTML ? ' ' + iconHTML : '');
            } else {
                element.textContent = translation;
            }
        }
    });
    
    // Atualizar conte√∫do din√¢mico espec√≠fico
    updateDynamicContent();
    
    console.log('Idioma alterado com sucesso para:', lang); // Debug
}

// Fun√ß√£o para atualizar conte√∫do din√¢mico
function updateDynamicContent() {
    // Hero slides
    const heroTitles = document.querySelectorAll('.hero-slide-title');
    const heroDescriptions = document.querySelectorAll('.hero-slide p');
    
    if (heroTitles.length >= 4) {
        heroTitles[0].textContent = t('hero.cafe.title');
        heroTitles[1].textContent = t('hero.soja.title');
        heroTitles[2].textContent = t('hero.comercio.title');
        heroTitles[3].textContent = t('hero.milho.title');
    }
    
    if (heroDescriptions.length >= 4) {
        heroDescriptions[0].textContent = t('hero.cafe.description');
        heroDescriptions[1].textContent = t('hero.soja.description');
        heroDescriptions[2].textContent = t('hero.comercio.description');
        heroDescriptions[3].textContent = t('hero.milho.description');
    }
    
    // Bot√µes "Ver Categorias" no hero
    document.querySelectorAll('a.btn-accent[href="#categorias"]').forEach(btn => {
        btn.innerHTML = `${t('hero.verCategorias')} <i class="fas fa-arrow-down ml-2"></i>`;
    });
    
    // Bot√µes "Solicitar Cota√ß√£o" (EXCLUIR o bot√£o flutuante)
    document.querySelectorAll('a[href*="wa.me"]').forEach(btn => {
        // PROTEGER o bot√£o flutuante - nunca modificar
        if (btn.id === 'whatsapp-btn' || btn.classList.contains('whatsapp-float') || btn.hasAttribute('data-whatsapp-number')) {
            // Garantir que o bot√£o flutuante tenha apenas o √≠cone
            if (btn.querySelector('i.fab.fa-whatsapp')) {
                const icon = btn.querySelector('i.fab.fa-whatsapp');
                // Remover qualquer texto
                btn.textContent = '';
                // Garantir que s√≥ tenha o √≠cone
                if (icon.parentElement !== btn || btn.children.length > 1) {
                    btn.innerHTML = '';
                    const newIcon = document.createElement('i');
                    newIcon.className = 'fab fa-whatsapp';
                    btn.appendChild(newIcon);
                }
                // Remover classes de margem do √≠cone
                icon.classList.remove('mr-2');
            }
            return; // Pular o bot√£o flutuante
        }
        
        // Atualizar apenas bot√µes que N√ÉO s√£o flutuantes
        const icon = btn.querySelector('i.fab.fa-whatsapp');
        if (icon) {
            btn.innerHTML = `<i class="fab fa-whatsapp mr-2"></i> ${t('product.solicitarCotacao')}`;
        }
    });
    
    // Bot√µes "Ver Mais Produtos"
    document.querySelectorAll('#ver-mais-produtos-btn').forEach(btn => {
        btn.innerHTML = `<i class="fab fa-whatsapp mr-2"></i> ${t('product.verMaisProdutos')}`;
    });
}

// Inicializar idioma ao carregar a p√°gina (apenas se o header j√° estiver no DOM)
document.addEventListener('DOMContentLoaded', () => {
    // Verificar se o header j√° est√° carregado (p√°ginas sem header-placeholder)
    const header = document.getElementById('header');
    if (header) {
        setLanguage(currentLang);
    }
    // Se n√£o estiver, ser√° inicializado pelo components.js ap√≥s carregar o header
});

